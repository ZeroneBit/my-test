(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{101:function(e,n,o){"use strict";o.d(n,"a",function(){return f});var t=o(22),i=o(12),r=o(25),s=o(23),c=o(24),a=o(111),u=o(112),l=o.n(u),p=o(86),f=function(e){function n(){var e;return Object(t.a)(this,n),(e=Object(r.a)(this,Object(s.a)(n).call(this))).peer=null,e.pairs={},e.outgoing=[],e._initializePeer(),e}return Object(c.a)(n,e),Object(i.a)(n,[{key:"requestFileInfos",value:function(e){return this._ensureConnection(e,function(e){console.log("sending request "+e.open);var n={type:p.a.Request_File_Infos};e.send(JSON.stringify(n))}),p.b.Info_Got}},{key:"setOutgingFiles",value:function(e){var n=this;if(e)for(var o=function(o){var t=e.item(o);n.outgoing.findIndex(function(e){return e.name==t.name})<0&&n.outgoing.push({name:t.name,size:t.size,type:t.type})},t=0;t<e.length;t++)o(t)}},{key:"_initializePeer",value:function(){this.peer=new l.a(null,{debug:3,confi:{iceServers:[{url:"stun:stun.services.mozilla.com"},{url:"turn:numb.viagenie.ca",credential:"muazkh",username:"webrtc@live.com"}]}}),this.peer.on("open",this._peerOpen.bind(this)),this.peer.on("connection",this._peerConnection.bind(this)),this.peer.on("disconnected",this._peerDisconnected.bind(this)),this.peer.on("close",this._peerClose.bind(this)),this.peer.on("error",this._peerError.bind(this))}},{key:"_peerOpen",value:function(e){this.emit(p.b.Peer_Opened,e)}},{key:"_peerConnection",value:function(e){var n=this.pairs[e.peer];n&&n.conn&&n.conn.open||(this.pairs[e.peer]={conn:e},console.log("_peerConnection "+e.open),this._initializeConnection(e))}},{key:"_peerDisconnected",value:function(){}},{key:"_peerClose",value:function(){}},{key:"_peerError",value:function(e){console.error("Peer error "+e.type),console.error(e)}},{key:"_ensureConnection",value:function(e,n){var o=this.pairs[e];if(o||(this.pairs[e]={},o=this.pairs[e]),!o.conn||!o.conn.open)return o.conn=this.peer.connect(e),console.log("this.peer.connect"+o.conn.open),void this._initializeConnection(o.conn,n);n&&n(o.conn)}},{key:"_initializeConnection",value:function(e,n){var o=this;e.on("open",function(){console.log("conn opened"),n&&n(e)}),e.on("data",function(n){void 0!==n.byteLength||o._onJSONData(JSON.parse(n),e)}),e.on("error",function(n){o._connError(n,e)}),e.on("close",function(){o._connClose(e)})}},{key:"_connError",value:function(e,n){console.error(e)}},{key:"_connClose",value:function(e){console.error("conn closed")}},{key:"_onJSONData",value:function(e,n){switch(e.type){case p.a.Request_File_Infos:var o={type:p.a.Response_File_INfos,payload:this.outgoing};n.send(JSON.stringify(o));break;case p.a.Response_File_INfos:this.pairs[n.peer].incoming=e.payload,this.emit(p.b.Info_Got,n.peer,e.payload);break;case"":break;default:console.error("Unknown message: "+e)}}}]),n}(a.EventEmitter)},113:function(e,n){function o(e){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}o.keys=function(){return[]},o.resolve=o,e.exports=o,o.id=113},174:function(e,n,o){"use strict";o.r(n);var t=o(22),i=o(12),r=o(25),s=o(23),c=o(24),a=o(0),u=o.n(a),l=o(168),p=o(11),f=o(101),h=o(86),_=function(e){function n(e){var o;return Object(t.a)(this,n),(o=Object(r.a)(this,Object(s.a)(n).call(this,e))).remoteId=e.match.params.id,o.peer=null,o}return Object(c.a)(n,e),Object(i.a)(n,[{key:"componentWillMount",value:function(){this.myPeer=new f.a,this.initializeMyPeer()}},{key:"initializeMyPeer",value:function(){this.myPeer.on(h.b.Peer_Opened,function(e){console.log(e)}),this.myPeer.on(h.b.Info_Got,function(e,n){console.log(n),alert(n)})}},{key:"retriveFileInfos",value:function(e){this.myPeer.requestFileInfos(this.remoteId)}},{key:"render",value:function(){var e=this.props.classes;return u.a.createElement("div",null,u.a.createElement(l.a,{variant:"contained",component:"span",className:e.button,color:"primary",onClick:this.retriveFileInfos.bind(this)},"Retrive Files"))}}]),n}(u.a.Component);n.default=Object(p.a)(function(e){return{button:{margin:e.spacing(1)},buttonInput:{display:"none"}}},{withTheme:!0})(_)},86:function(e,n,o){"use strict";o.d(n,"a",function(){return i}),o.d(n,"b",function(){return r});var t=o(22),i=function e(){Object(t.a)(this,e)};i.Request_File_Infos="request_file_infos",i.Response_File_INfos="response_file_infos";var r=function e(){Object(t.a)(this,e)};r.Peer_Opened="peer_opened",r.Info_Got="info_got"}}]);
//# sourceMappingURL=7.bc506218.chunk.js.map